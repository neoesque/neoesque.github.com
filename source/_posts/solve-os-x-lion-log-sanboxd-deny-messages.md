---
layout: post
title: "解決 OS X Lion 中 Log 一直出現 sanboxd deny 的訊息"
date: 2011-12-13
comments: false
tags: ["Mac"]
categories: ["資訊"]
---

雖然不是什麼大不了的事情<br /><br />不過看了總是很不順眼 XD<br /><br />就是每次開 Console Log 都會噴一堆<br /><br /><pre>sandboxd: ([]) WebProcess() deny file-read-data /Library/Caches/com.nvidia.OpenGL<br />sandboxd: ([]) WebProcess() deny file-write-create /Library/Caches/com.nvidia.OpenGL/<br /></pre><br />之類的 deny 訊息，如下圖<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" height="247" width="640" src="http://2.bp.blogspot.com/-KgSJHGoTXfM/TudwWeh_3lI/AAAAAAAAC7A/nnW32mD6ktw/s640/%25E8%259E%25A2%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2011-12-13%2B%25E4%25B8%258B%25E5%258D%25889.59.03.jpg" /></div><br />這看了很讓人不順眼阿！<br /><!--more-->於是開始從源頭找...<br /><br />首先是 OS X 的 sandbox 機制，每個被 sandboxd (sandbox daemon) 限制住的 process 都有一個對應的設定檔<br /><br />裡面寫著該 process 可以 access 那些檔案 (包含 allow & deny) 而且設定檔的副檔名是 .sb<br /><br />在以下資料夾可以發現系統預設的 sandbox 的 profile<br /><br /><ul><li>/System/Library/Sandbox/Profiles/</li><li>/Library/Sandbox/Profiles/</li><li>/usr/share/sandbox/</li></ul><br />不過這些都是系統相關的檔案而非應用程式的<br /><br />應用程式的 profile 通常會在他自己目錄下的 Resources<br /><br />例如我們這裡的 WebProcess 指的就是 WebKit2 的一個 Process 而他的 sb profile 就在<br /><br />/System/Library/PrivateFrameworks/WebKit2.framework/WebProcess.app/Contents/Resources/<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" height="288" width="640" src="http://2.bp.blogspot.com/-kBeJ7y9UlhU/Tudt-_9B7kI/AAAAAAAAC6o/TQKqNy_njRA/s640/%25E8%259E%25A2%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2011-12-13%2B%25E4%25B8%258B%25E5%258D%258811.23.24.png" /></div><br />如圖所示，我們可以看到底下有個名為 com.apple.WebProcess.sb 的檔案<br /><br />我們只要用 vi 編輯她即可<br /><br />加入下列文字，表示給與 WebProcess 對於 /Library/Caches/com.nvidia.OpenGL 的讀寫權限<br /><br />{% gist 1472514 %}<br />類似這樣<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" height="288" width="640" src="http://1.bp.blogspot.com/-mxG99WctcDM/Tudu5M_Dc2I/AAAAAAAAC60/zTlOZhBAbKk/s640/%25E8%259E%25A2%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2011-12-13%2B%25E4%25B8%258B%25E5%258D%258811.27.17.png" /></div><br />加在最下方後重新啟動 Safari 就大功告成啦！<br /><br />再看 Console Log 應該就沒有這些訊息了~<br /><br />不過雖然是看不到了 不過也因為把權限放大了一些不知道會不會出事 XD
